name: Parking Full Rejection
version: 1

steps:
  - wait-serial: "Console ready"
  # Car 1 enters
  - set-control:
      part-id: btn-entry
      control: pressed
      value: 0
  - delay: 100ms
  - set-control:
      part-id: btn-entry
      control: pressed
      value: 1
  - wait-serial: "Ticket issued: ID=1"
  - wait-serial: "OpeningBarrier"
  - delay: 600ms
  - set-control:
      part-id: light-entry
      control: value
      value: 1
  - wait-serial: "CarPassing"
  - set-control:
      part-id: light-entry
      control: value
      value: 0
  - wait-serial: "ClosingBarrier"
  - wait-serial: "Idle"

  # Car 2 enters
  - set-control:
      part-id: btn-entry
      control: pressed
      value: 0
  - delay: 100ms
  - set-control:
      part-id: btn-entry
      control: pressed
      value: 1
  - wait-serial: "Ticket issued: ID=2"
  - wait-serial: "OpeningBarrier"
  - delay: 600ms
  - set-control:
      part-id: light-entry
      control: value
      value: 1
  - wait-serial: "CarPassing"
  - set-control:
      part-id: light-entry
      control: value
      value: 0
  - wait-serial: "ClosingBarrier"
  - wait-serial: "Idle"

  # Car 3 tries to enter - should be rejected (capacity=2)
  - set-control:
      part-id: btn-entry
      control: pressed
      value: 0
  - delay: 100ms
  - set-control:
      part-id: btn-entry
      control: pressed
      value: 1

  - wait-serial: "Parking full"
  - wait-serial: "Idle"
