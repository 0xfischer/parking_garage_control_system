name: Full Entry + Payment + Exit via Console
version: 1

steps:
  # Boot + Console bereit
  - wait-serial: "Console ready"

  # ENTRY: Ticket auslösen über Event-Publish
  - write-serial: "publish EntryButtonPressed\r\n"
  - wait-serial: "Ticket issued"
  - wait-serial: "OpeningBarrier"
  - wait-serial: "WaitingForCar"

  # Simuliere Fahrzeug passiert die Eintritts-Lichtschranke (nur Events, keine GPIO)
  - write-serial: "publish EntryLightBarrierBlocked\r\n"
  - wait-serial: "CarPassing"
  - write-serial: "publish EntryLightBarrierCleared\r\n"
  - wait-serial: "ClosingBarrier"
  - wait-serial: "Idle"

  # PAYMENT: Ticket bezahlen per Console
  - write-serial: "ticket pay 1\r\n"
  - wait-serial: "paid successfully"

  # EXIT: Ticket validieren per Console
  - write-serial: "ticket validate 1\r\n"
  - wait-serial: "validated successfully"
  - wait-serial: "OpeningBarrier"
  - wait-serial: "WaitingForCarToPass"

  # Simuliere Fahrzeug passiert die Ausfahrts-Lichtschranke (nur Events)
  - write-serial: "publish ExitLightBarrierBlocked\r\n"
  - wait-serial: "CarPassing"
  - write-serial: "publish ExitLightBarrierCleared\r\n"
  - wait-serial: "ClosingBarrier"
  - wait-serial: "Idle"