name: Complete Entry Flow
version: 1

steps:
  # Wait for console ready
  - wait-serial: "Console ready"

  # Press entry button (active-low)
  - set-control:
      part-id: btn-entry
      control: pressed
      value: 0
  - delay: 100ms
  - set-control:
      part-id: btn-entry
      control: pressed
      value: 1

  # Verify ticket issued
  - wait-serial: "Ticket issued"

  # Verify barrier opening
  - wait-serial: "OpeningBarrier"

  # Wait for barrier to open
  - delay: 2.5s

  # Simulate car blocking light barrier (slide switch ON)
  - set-control:
      part-id: light-entry
      control: value
      value: 1

  # Verify car passing state
  - wait-serial: "CarPassing"

  # Simulate car clearing light barrier (slide switch OFF)
  - set-control:
      part-id: light-entry
      control: value
      value: 0

  # Wait for 2-second safety delay + closing
  - wait-serial: "ClosingBarrier"

  # Verify return to idle
  - wait-serial: "Idle"