name: Complete Entry Flow
version: 1

steps:
  # Wait for system boot
  - wait: 3000

  # Wait for console ready
  - serial-wait-for: "Console ready"
    timeout: 10000

  # Press entry button
  - button-press: btn-entry
    duration: 100

  # Verify ticket issued
  - serial-wait-for: "Ticket issued"
    timeout: 5000

  # Verify barrier opening
  - serial-wait-for: "OpeningBarrier"
    timeout: 2000

  # Wait for barrier to open
  - wait: 2500

  # Simulate car blocking light barrier (slide switch ON)
  - set-control:
      part: light-entry
      control: value
      value: 1

  # Verify car passing state
  - serial-wait-for: "CarPassing"
    timeout: 2000

  # Simulate car clearing light barrier (slide switch OFF)
  - set-control:
      part: light-entry
      control: value
      value: 0

  # Wait for 2-second safety delay + closing
  - serial-wait-for: "ClosingBarrier"
    timeout: 5000

  # Verify return to idle
  - serial-wait-for: "Idle"
    timeout: 3000
